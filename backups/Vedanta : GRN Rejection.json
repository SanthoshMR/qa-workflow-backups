{
  "active": false,
  "connections": {
    "IMAP Email": {
      "main": [
        [
          {
            "node": "Function",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function": {
      "main": [
        []
      ]
    }
  },
  "createdAt": "2022-10-14T07:43:04.562Z",
  "id": "211",
  "name": "Vedanta : GRN Rejection",
  "nodes": [
    {
      "parameters": {},
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "format": "resolved",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "name": "IMAP Email",
      "type": "n8n-nodes-base.emailReadImap",
      "typeVersion": 1,
      "position": [
        460,
        300
      ],
      "credentials": {
        "imap": {
          "id": "18",
          "name": "Imap creds(sai)"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "function extractTableData(tableContent) {\n  // var parser = new DOMParser();\n  // var htmlContent=parser.parseFromString(tableContent, 'text/html');\n  const cheerio = require('cheerio');\n  const $ = cheerio.load(tableContent);\n  var data=[];\n  var headerData=[];  \n  var rowData = $(\"table tr\");   \n  for(var i = 0 ; i < rowData.length ; i++) { \n  \tlet dataObject={};    \n    let columnData = $(rowData[i]).children('td');  \n    for(var j = 0 ; j < columnData.length ; j++) { \n      if(i == 0){\n        headerData.push($(columnData[j]).text().replace(/[^a-zA-Z0-9]/g, \"\"));\n      }\n      else{\n        dataObject[headerData[j]]=$(columnData[j]).text();\n      }\n    }\n    if(i > 0){\n    \tdata.push(dataObject);\n    }\n  }\n  \n  return data;\n};\n\nvar htmlData=$node[\"IMAP Email\"].json[\"html\"];\nreturn extractTableData(htmlData);\n"
      },
      "name": "Function",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        660,
        300
      ]
    }
  ],
  "settings": {},
  "staticData": null,
  "tags": [
    {
      "id": "5",
      "name": "Mozart",
      "createdAt": "2022-05-30T07:16:52.136Z",
      "updatedAt": "2022-05-30T07:16:52.136Z"
    }
  ],
  "updatedAt": "2022-10-15T14:21:30.169Z"
}